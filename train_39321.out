Job started on ptolemy-gpu-02 at Wed Apr 30 12:30:07 AM CDT 2025
SLURM Job ID: 39321
Number of CPUs allocated: 1
Memory allocated: 
Batch size: 64
This job has 1 worker and 100 epochs assigned.
unfrozen encoder layer= 4 | head_lr =1e-4 | encoder_lr = 2e-5
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 1
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.0191 | train_acc: 0.2801 | val_loss: 1.7757 | val_acc: 0.3822
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 2 | train_loss: 1.6578 | train_acc: 0.4579 | val_loss: 1.5753 | val_acc: 0.4555
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 3 | train_loss: 1.4627 | train_acc: 0.5671 | val_loss: 1.4503 | val_acc: 0.5673
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 4 | train_loss: 1.3412 | train_acc: 0.6275 | val_loss: 1.4089 | val_acc: 0.6266
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 5 | train_loss: 1.2350 | train_acc: 0.6896 | val_loss: 1.3390 | val_acc: 0.6615
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 6 | train_loss: 1.1596 | train_acc: 0.7186 | val_loss: 1.3494 | val_acc: 0.6290
Epoch 6 - No improvement in validation loss.
Epoch: 7 | train_loss: 1.0925 | train_acc: 0.7576 | val_loss: 1.3319 | val_acc: 0.6542
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 8 | train_loss: 1.0324 | train_acc: 0.7761 | val_loss: 1.3104 | val_acc: 0.6498
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 9 | train_loss: 0.9848 | train_acc: 0.8000 | val_loss: 1.2432 | val_acc: 0.6683
Saved best model checkpoint to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Epoch: 10 | train_loss: 0.9601 | train_acc: 0.8206 | val_loss: 1.3244 | val_acc: 0.6571
Epoch 10 - No improvement in validation loss.
Epoch: 11 | train_loss: 0.9267 | train_acc: 0.8273 | val_loss: 1.3162 | val_acc: 0.6350
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 0.8787 | train_acc: 0.8557 | val_loss: 1.3454 | val_acc: 0.6506
Epoch 12 - No improvement in validation loss.
Epoch: 13 | train_loss: 0.8576 | train_acc: 0.8618 | val_loss: 1.3000 | val_acc: 0.6482
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 0.8414 | train_acc: 0.8657 | val_loss: 1.3743 | val_acc: 0.6526
Epoch 14 - No improvement in validation loss.
Epoch: 15 | train_loss: 0.8256 | train_acc: 0.8733 | val_loss: 1.3186 | val_acc: 0.6679
Epoch 15 - No improvement in validation loss.
Epoch: 16 | train_loss: 0.7967 | train_acc: 0.8898 | val_loss: 1.3583 | val_acc: 0.6474
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 0.7992 | train_acc: 0.8862 | val_loss: 1.3978 | val_acc: 0.6426
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 0.7777 | train_acc: 0.8945 | val_loss: 1.3465 | val_acc: 0.6538
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 0.7673 | train_acc: 0.8971 | val_loss: 1.3046 | val_acc: 0.6803
Epoch 19 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2432 achieved. Best model saved to checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Loading best model from checkpoints/best_model_slurm_39321_2025-04-30 00:30:16.804117.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2842, Test Accuracy: 0.6355
Python script finished with exit code 0 at Wed Apr 30 01:05:39 AM CDT 2025
