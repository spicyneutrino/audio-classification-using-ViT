Job started on ptolemy-gpu-05 at Wed Apr 30 04:44:24 PM CDT 2025
SLURM Job ID: 39690
Number of CPUs allocated: 32
Memory allocated: 
Batch size: 64
This job has 32 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 3e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 32
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.0914 | train_acc: 0.2465 | val_loss: 1.8496 | val_acc: 0.3221
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 2 | train_loss: 1.8778 | train_acc: 0.3522 | val_loss: 1.7543 | val_acc: 0.3594
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 3 | train_loss: 1.7222 | train_acc: 0.4378 | val_loss: 1.6489 | val_acc: 0.4639
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 4 | train_loss: 1.6035 | train_acc: 0.5033 | val_loss: 1.5569 | val_acc: 0.5501
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 5 | train_loss: 1.5017 | train_acc: 0.5540 | val_loss: 1.4942 | val_acc: 0.5621
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 6 | train_loss: 1.4300 | train_acc: 0.5885 | val_loss: 1.4715 | val_acc: 0.5781
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 7 | train_loss: 1.3798 | train_acc: 0.6213 | val_loss: 1.4251 | val_acc: 0.6114
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 8 | train_loss: 1.3417 | train_acc: 0.6320 | val_loss: 1.4060 | val_acc: 0.6290
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 9 | train_loss: 1.3045 | train_acc: 0.6638 | val_loss: 1.4359 | val_acc: 0.6130
Epoch 9 - No improvement in validation loss.
Epoch: 10 | train_loss: 1.2735 | train_acc: 0.6744 | val_loss: 1.3832 | val_acc: 0.6462
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 11 | train_loss: 1.2502 | train_acc: 0.6867 | val_loss: 1.4366 | val_acc: 0.6162
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 1.2342 | train_acc: 0.6917 | val_loss: 1.3479 | val_acc: 0.6579
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 13 | train_loss: 1.2009 | train_acc: 0.7086 | val_loss: 1.3578 | val_acc: 0.6434
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 1.1882 | train_acc: 0.7172 | val_loss: 1.3516 | val_acc: 0.6394
Epoch 14 - No improvement in validation loss.
Epoch: 15 | train_loss: 1.1604 | train_acc: 0.7218 | val_loss: 1.3472 | val_acc: 0.6306
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 16 | train_loss: 1.1430 | train_acc: 0.7348 | val_loss: 1.3636 | val_acc: 0.6390
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 1.1381 | train_acc: 0.7402 | val_loss: 1.3477 | val_acc: 0.6715
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 1.1042 | train_acc: 0.7528 | val_loss: 1.4155 | val_acc: 0.6438
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 1.1031 | train_acc: 0.7544 | val_loss: 1.2810 | val_acc: 0.6583
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 20 | train_loss: 1.0849 | train_acc: 0.7601 | val_loss: 1.3463 | val_acc: 0.6290
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 1.0909 | train_acc: 0.7646 | val_loss: 1.3086 | val_acc: 0.6727
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 1.0724 | train_acc: 0.7644 | val_loss: 1.2893 | val_acc: 0.6599
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.0601 | train_acc: 0.7726 | val_loss: 1.3419 | val_acc: 0.6562
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 1.0333 | train_acc: 0.7879 | val_loss: 1.2969 | val_acc: 0.6707
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.0259 | train_acc: 0.7863 | val_loss: 1.2592 | val_acc: 0.6731
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 26 | train_loss: 1.0234 | train_acc: 0.7895 | val_loss: 1.2485 | val_acc: 0.6562
Saved best model checkpoint to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Epoch: 27 | train_loss: 1.0126 | train_acc: 0.7944 | val_loss: 1.3083 | val_acc: 0.6855
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 1.0059 | train_acc: 0.8007 | val_loss: 1.2754 | val_acc: 0.6771
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 1.0024 | train_acc: 0.8007 | val_loss: 1.3147 | val_acc: 0.6675
Epoch 29 - No improvement in validation loss.
Epoch: 30 | train_loss: 0.9991 | train_acc: 0.8030 | val_loss: 1.3165 | val_acc: 0.6815
Epoch 30 - No improvement in validation loss.
Epoch: 31 | train_loss: 0.9844 | train_acc: 0.8036 | val_loss: 1.2782 | val_acc: 0.6771
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 0.9891 | train_acc: 0.8062 | val_loss: 1.3043 | val_acc: 0.6575
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 0.9684 | train_acc: 0.8129 | val_loss: 1.2995 | val_acc: 0.6811
Epoch 33 - No improvement in validation loss.
Epoch: 34 | train_loss: 0.9667 | train_acc: 0.8114 | val_loss: 1.3236 | val_acc: 0.6931
Epoch 34 - No improvement in validation loss.
Epoch: 35 | train_loss: 0.9552 | train_acc: 0.8232 | val_loss: 1.2544 | val_acc: 0.6783
Epoch 35 - No improvement in validation loss.
Epoch: 36 | train_loss: 0.9603 | train_acc: 0.8203 | val_loss: 1.3383 | val_acc: 0.6763
Epoch 36 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2485 achieved. Best model saved to checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Loading best model from checkpoints/best_model_slurm_39690_2025-04-30 16:44:35.835059.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2052, Test Accuracy: 0.6855
Python script finished with exit code 0 at Wed Apr 30 05:13:18 PM CDT 2025
