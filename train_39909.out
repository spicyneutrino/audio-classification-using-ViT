Job started on ptolemy-gpu-01 at Thu May  1 09:03:34 AM CDT 2025
SLURM Job ID: 39909
Number of CPUs allocated: 32
Memory allocated: 
Batch size: 64
This job has 32 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 3e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 32
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.1013 | train_acc: 0.2379 | val_loss: 1.8554 | val_acc: 0.3385
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 2 | train_loss: 1.8595 | train_acc: 0.3569 | val_loss: 1.7320 | val_acc: 0.4091
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 3 | train_loss: 1.7096 | train_acc: 0.4442 | val_loss: 1.6035 | val_acc: 0.5561
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 4 | train_loss: 1.5907 | train_acc: 0.5076 | val_loss: 1.5273 | val_acc: 0.5172
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 5 | train_loss: 1.4974 | train_acc: 0.5605 | val_loss: 1.4914 | val_acc: 0.5649
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 6 | train_loss: 1.4459 | train_acc: 0.5876 | val_loss: 1.4659 | val_acc: 0.5721
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 7 | train_loss: 1.3879 | train_acc: 0.6143 | val_loss: 1.4645 | val_acc: 0.5793
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 8 | train_loss: 1.3437 | train_acc: 0.6392 | val_loss: 1.4203 | val_acc: 0.6078
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 9 | train_loss: 1.3112 | train_acc: 0.6586 | val_loss: 1.3961 | val_acc: 0.6354
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 10 | train_loss: 1.2723 | train_acc: 0.6766 | val_loss: 1.4290 | val_acc: 0.6258
Epoch 10 - No improvement in validation loss.
Epoch: 11 | train_loss: 1.2601 | train_acc: 0.6768 | val_loss: 1.3732 | val_acc: 0.6390
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 12 | train_loss: 1.2192 | train_acc: 0.7035 | val_loss: 1.4128 | val_acc: 0.6338
Epoch 12 - No improvement in validation loss.
Epoch: 13 | train_loss: 1.1999 | train_acc: 0.7075 | val_loss: 1.3704 | val_acc: 0.6390
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 14 | train_loss: 1.1798 | train_acc: 0.7195 | val_loss: 1.3536 | val_acc: 0.6583
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 15 | train_loss: 1.1618 | train_acc: 0.7235 | val_loss: 1.3670 | val_acc: 0.6591
Epoch 15 - No improvement in validation loss.
Epoch: 16 | train_loss: 1.1420 | train_acc: 0.7338 | val_loss: 1.3543 | val_acc: 0.6390
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 1.1335 | train_acc: 0.7403 | val_loss: 1.3566 | val_acc: 0.6462
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 1.1156 | train_acc: 0.7464 | val_loss: 1.2981 | val_acc: 0.6434
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 19 | train_loss: 1.0884 | train_acc: 0.7582 | val_loss: 1.3285 | val_acc: 0.6546
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 1.0862 | train_acc: 0.7579 | val_loss: 1.3272 | val_acc: 0.6430
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 1.0800 | train_acc: 0.7654 | val_loss: 1.3173 | val_acc: 0.6550
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 1.0701 | train_acc: 0.7668 | val_loss: 1.3306 | val_acc: 0.6587
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.0376 | train_acc: 0.7773 | val_loss: 1.3349 | val_acc: 0.6583
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 1.0368 | train_acc: 0.7865 | val_loss: 1.3286 | val_acc: 0.6599
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.0156 | train_acc: 0.7960 | val_loss: 1.3911 | val_acc: 0.6558
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 1.0189 | train_acc: 0.7873 | val_loss: 1.3097 | val_acc: 0.6787
Epoch 26 - No improvement in validation loss.
Epoch: 27 | train_loss: 0.9999 | train_acc: 0.7961 | val_loss: 1.2840 | val_acc: 0.6831
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 28 | train_loss: 1.0002 | train_acc: 0.7999 | val_loss: 1.3217 | val_acc: 0.6647
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 0.9924 | train_acc: 0.8050 | val_loss: 1.2981 | val_acc: 0.6751
Epoch 29 - No improvement in validation loss.
Epoch: 30 | train_loss: 0.9835 | train_acc: 0.8081 | val_loss: 1.3017 | val_acc: 0.6987
Epoch 30 - No improvement in validation loss.
Epoch: 31 | train_loss: 0.9708 | train_acc: 0.8135 | val_loss: 1.3010 | val_acc: 0.6835
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 0.9676 | train_acc: 0.8128 | val_loss: 1.2866 | val_acc: 0.6955
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 0.9580 | train_acc: 0.8179 | val_loss: 1.2972 | val_acc: 0.6959
Epoch 33 - No improvement in validation loss.
Epoch: 34 | train_loss: 0.9569 | train_acc: 0.8200 | val_loss: 1.2958 | val_acc: 0.6715
Epoch 34 - No improvement in validation loss.
Epoch: 35 | train_loss: 0.9513 | train_acc: 0.8215 | val_loss: 1.2668 | val_acc: 0.6771
Saved best model checkpoint to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Epoch: 36 | train_loss: 0.9323 | train_acc: 0.8312 | val_loss: 1.3356 | val_acc: 0.6751
Epoch 36 - No improvement in validation loss.
Epoch: 37 | train_loss: 0.9344 | train_acc: 0.8281 | val_loss: 1.2932 | val_acc: 0.6835
Epoch 37 - No improvement in validation loss.
Epoch: 38 | train_loss: 0.9323 | train_acc: 0.8313 | val_loss: 1.2908 | val_acc: 0.7063
Epoch 38 - No improvement in validation loss.
Epoch: 39 | train_loss: 0.9231 | train_acc: 0.8358 | val_loss: 1.2982 | val_acc: 0.6959
Epoch 39 - No improvement in validation loss.
Epoch: 40 | train_loss: 0.9140 | train_acc: 0.8406 | val_loss: 1.2947 | val_acc: 0.6955
Epoch 40 - No improvement in validation loss.
Epoch: 41 | train_loss: 0.9178 | train_acc: 0.8368 | val_loss: 1.2758 | val_acc: 0.7051
Epoch 41 - No improvement in validation loss.
Epoch: 42 | train_loss: 0.9067 | train_acc: 0.8448 | val_loss: 1.3181 | val_acc: 0.6943
Epoch 42 - No improvement in validation loss.
Epoch: 43 | train_loss: 0.9081 | train_acc: 0.8437 | val_loss: 1.3360 | val_acc: 0.6907
Epoch 43 - No improvement in validation loss.
Epoch: 44 | train_loss: 0.8936 | train_acc: 0.8476 | val_loss: 1.2785 | val_acc: 0.6943
Epoch 44 - No improvement in validation loss.
Epoch: 45 | train_loss: 0.8947 | train_acc: 0.8460 | val_loss: 1.2978 | val_acc: 0.7015
Epoch 45 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2668 achieved. Best model saved to checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Loading best model from checkpoints/best_model_slurm_39909_2025-05-01 09:03:47.331263.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2124, Test Accuracy: 0.6964
Python script finished with exit code 0 at Thu May  1 09:40:27 AM CDT 2025
