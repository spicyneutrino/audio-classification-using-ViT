Job started on ptolemy-gpu-04 at Sun May 11 08:49:26 AM CDT 2025
SLURM Job ID: 44099
Number of CPUs allocated: 32
Memory allocated: 
Batch size: 128
This job has 32 worker and 500 epochs assigned.
HEAD_LR: 8e-5 | ENCODER_LR: 1e-5 | USE_TIME_AUGMENT: True
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 32
Batch size: 128
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.2451 | train_acc: 0.1944 | val_loss: 1.9854 | val_acc: 0.2853
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 2 | train_loss: 2.0980 | train_acc: 0.2645 | val_loss: 1.8892 | val_acc: 0.3017
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 3 | train_loss: 2.0589 | train_acc: 0.2862 | val_loss: 1.8429 | val_acc: 0.3620
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 4 | train_loss: 2.0113 | train_acc: 0.3176 | val_loss: 1.7802 | val_acc: 0.3735
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 5 | train_loss: 1.9517 | train_acc: 0.3572 | val_loss: 1.7309 | val_acc: 0.4416
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 6 | train_loss: 1.9375 | train_acc: 0.3658 | val_loss: 1.7054 | val_acc: 0.4334
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 7 | train_loss: 1.8957 | train_acc: 0.3912 | val_loss: 1.6576 | val_acc: 0.4743
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 8 | train_loss: 1.8881 | train_acc: 0.4052 | val_loss: 1.6141 | val_acc: 0.5022
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 9 | train_loss: 1.8035 | train_acc: 0.4437 | val_loss: 1.5897 | val_acc: 0.5126
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 10 | train_loss: 1.7971 | train_acc: 0.4586 | val_loss: 1.5677 | val_acc: 0.5052
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 11 | train_loss: 1.7899 | train_acc: 0.4703 | val_loss: 1.5476 | val_acc: 0.5748
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 12 | train_loss: 1.7430 | train_acc: 0.4971 | val_loss: 1.5174 | val_acc: 0.5543
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 13 | train_loss: 1.7625 | train_acc: 0.4915 | val_loss: 1.5017 | val_acc: 0.5949
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 14 | train_loss: 1.6988 | train_acc: 0.5162 | val_loss: 1.4867 | val_acc: 0.6031
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 15 | train_loss: 1.7198 | train_acc: 0.5113 | val_loss: 1.4725 | val_acc: 0.5967
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 16 | train_loss: 1.6845 | train_acc: 0.5232 | val_loss: 1.4678 | val_acc: 0.6094
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 17 | train_loss: 1.7154 | train_acc: 0.5160 | val_loss: 1.4452 | val_acc: 0.6217
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 18 | train_loss: 1.6468 | train_acc: 0.5442 | val_loss: 1.4650 | val_acc: 0.5644
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 1.7081 | train_acc: 0.5320 | val_loss: 1.4339 | val_acc: 0.6228
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 20 | train_loss: 1.6814 | train_acc: 0.5462 | val_loss: 1.4435 | val_acc: 0.6004
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 1.7353 | train_acc: 0.5173 | val_loss: 1.4161 | val_acc: 0.6209
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 22 | train_loss: 1.6563 | train_acc: 0.5586 | val_loss: 1.4270 | val_acc: 0.6209
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.6430 | train_acc: 0.5561 | val_loss: 1.4134 | val_acc: 0.6414
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 24 | train_loss: 1.5728 | train_acc: 0.5974 | val_loss: 1.4115 | val_acc: 0.6198
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 25 | train_loss: 1.6062 | train_acc: 0.5879 | val_loss: 1.3748 | val_acc: 0.6711
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 26 | train_loss: 1.6152 | train_acc: 0.5792 | val_loss: 1.3740 | val_acc: 0.6417
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 27 | train_loss: 1.5846 | train_acc: 0.5982 | val_loss: 1.3784 | val_acc: 0.6622
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 1.5578 | train_acc: 0.6040 | val_loss: 1.3788 | val_acc: 0.6362
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 1.6253 | train_acc: 0.5700 | val_loss: 1.3583 | val_acc: 0.6592
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 30 | train_loss: 1.5746 | train_acc: 0.6092 | val_loss: 1.3469 | val_acc: 0.6544
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 31 | train_loss: 1.6214 | train_acc: 0.5787 | val_loss: 1.3598 | val_acc: 0.6481
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 1.5830 | train_acc: 0.5989 | val_loss: 1.3495 | val_acc: 0.6514
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 1.5487 | train_acc: 0.6304 | val_loss: 1.3454 | val_acc: 0.6629
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 34 | train_loss: 1.5400 | train_acc: 0.6356 | val_loss: 1.3297 | val_acc: 0.6566
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 35 | train_loss: 1.5670 | train_acc: 0.6240 | val_loss: 1.3338 | val_acc: 0.6700
Epoch 35 - No improvement in validation loss.
Epoch: 36 | train_loss: 1.6090 | train_acc: 0.5966 | val_loss: 1.3420 | val_acc: 0.6585
Epoch 36 - No improvement in validation loss.
Epoch: 37 | train_loss: 1.4966 | train_acc: 0.6533 | val_loss: 1.3498 | val_acc: 0.6574
Epoch 37 - No improvement in validation loss.
Epoch: 38 | train_loss: 1.5564 | train_acc: 0.6188 | val_loss: 1.3281 | val_acc: 0.6607
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 39 | train_loss: 1.5307 | train_acc: 0.6293 | val_loss: 1.3044 | val_acc: 0.6652
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 40 | train_loss: 1.4893 | train_acc: 0.6594 | val_loss: 1.3501 | val_acc: 0.6622
Epoch 40 - No improvement in validation loss.
Epoch: 41 | train_loss: 1.4834 | train_acc: 0.6573 | val_loss: 1.3013 | val_acc: 0.6629
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 42 | train_loss: 1.5585 | train_acc: 0.6159 | val_loss: 1.3040 | val_acc: 0.6708
Epoch 42 - No improvement in validation loss.
Epoch: 43 | train_loss: 1.4677 | train_acc: 0.6432 | val_loss: 1.2993 | val_acc: 0.6596
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 44 | train_loss: 1.4357 | train_acc: 0.6595 | val_loss: 1.2992 | val_acc: 0.6670
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 45 | train_loss: 1.4729 | train_acc: 0.6429 | val_loss: 1.2911 | val_acc: 0.6786
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 46 | train_loss: 1.4663 | train_acc: 0.6673 | val_loss: 1.3022 | val_acc: 0.6652
Epoch 46 - No improvement in validation loss.
Epoch: 47 | train_loss: 1.5663 | train_acc: 0.6255 | val_loss: 1.2946 | val_acc: 0.6745
Epoch 47 - No improvement in validation loss.
Epoch: 48 | train_loss: 1.3940 | train_acc: 0.6815 | val_loss: 1.2850 | val_acc: 0.6734
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 49 | train_loss: 1.4937 | train_acc: 0.6632 | val_loss: 1.2725 | val_acc: 0.6626
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 50 | train_loss: 1.5643 | train_acc: 0.6270 | val_loss: 1.2819 | val_acc: 0.6830
Epoch 50 - No improvement in validation loss.
Epoch: 51 | train_loss: 1.4974 | train_acc: 0.6568 | val_loss: 1.2882 | val_acc: 0.6708
Epoch 51 - No improvement in validation loss.
Epoch: 52 | train_loss: 1.5251 | train_acc: 0.6369 | val_loss: 1.2819 | val_acc: 0.6797
Epoch 52 - No improvement in validation loss.
Epoch: 53 | train_loss: 1.4769 | train_acc: 0.6718 | val_loss: 1.3023 | val_acc: 0.6685
Epoch 53 - No improvement in validation loss.
Epoch: 54 | train_loss: 1.4700 | train_acc: 0.6593 | val_loss: 1.2795 | val_acc: 0.6808
Epoch 54 - No improvement in validation loss.
Epoch: 55 | train_loss: 1.4252 | train_acc: 0.6796 | val_loss: 1.2738 | val_acc: 0.6801
Epoch 55 - No improvement in validation loss.
Epoch: 56 | train_loss: 1.4238 | train_acc: 0.6937 | val_loss: 1.2855 | val_acc: 0.6912
Epoch 56 - No improvement in validation loss.
Epoch: 57 | train_loss: 1.5253 | train_acc: 0.6558 | val_loss: 1.2561 | val_acc: 0.6942
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 58 | train_loss: 1.4303 | train_acc: 0.6791 | val_loss: 1.2623 | val_acc: 0.6860
Epoch 58 - No improvement in validation loss.
Epoch: 59 | train_loss: 1.5045 | train_acc: 0.6604 | val_loss: 1.2862 | val_acc: 0.6897
Epoch 59 - No improvement in validation loss.
Epoch: 60 | train_loss: 1.4754 | train_acc: 0.6704 | val_loss: 1.2911 | val_acc: 0.6786
Epoch 60 - No improvement in validation loss.
Epoch: 61 | train_loss: 1.4363 | train_acc: 0.6881 | val_loss: 1.2716 | val_acc: 0.6749
Epoch 61 - No improvement in validation loss.
Epoch: 62 | train_loss: 1.3827 | train_acc: 0.7243 | val_loss: 1.2749 | val_acc: 0.6827
Epoch 62 - No improvement in validation loss.
Epoch: 63 | train_loss: 1.5041 | train_acc: 0.6504 | val_loss: 1.2579 | val_acc: 0.6752
Epoch 63 - No improvement in validation loss.
Epoch: 64 | train_loss: 1.4181 | train_acc: 0.7004 | val_loss: 1.2597 | val_acc: 0.6875
Epoch 64 - No improvement in validation loss.
Epoch: 65 | train_loss: 1.4028 | train_acc: 0.7165 | val_loss: 1.2703 | val_acc: 0.7039
Epoch 65 - No improvement in validation loss.
Epoch: 66 | train_loss: 1.5217 | train_acc: 0.6594 | val_loss: 1.2405 | val_acc: 0.6927
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 67 | train_loss: 1.4078 | train_acc: 0.7024 | val_loss: 1.2214 | val_acc: 0.7050
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 68 | train_loss: 1.4144 | train_acc: 0.6995 | val_loss: 1.2504 | val_acc: 0.6838
Epoch 68 - No improvement in validation loss.
Epoch: 69 | train_loss: 1.4649 | train_acc: 0.6803 | val_loss: 1.2379 | val_acc: 0.6972
Epoch 69 - No improvement in validation loss.
Epoch: 70 | train_loss: 1.4737 | train_acc: 0.6829 | val_loss: 1.2488 | val_acc: 0.7005
Epoch 70 - No improvement in validation loss.
Epoch: 71 | train_loss: 1.4194 | train_acc: 0.6914 | val_loss: 1.2578 | val_acc: 0.6938
Epoch 71 - No improvement in validation loss.
Epoch: 72 | train_loss: 1.3931 | train_acc: 0.7075 | val_loss: 1.2786 | val_acc: 0.6797
Epoch 72 - No improvement in validation loss.
Epoch: 73 | train_loss: 1.4451 | train_acc: 0.6807 | val_loss: 1.2888 | val_acc: 0.6827
Epoch 73 - No improvement in validation loss.
Epoch: 74 | train_loss: 1.3854 | train_acc: 0.7191 | val_loss: 1.2507 | val_acc: 0.6938
Epoch 74 - No improvement in validation loss.
Epoch: 75 | train_loss: 1.3975 | train_acc: 0.7049 | val_loss: 1.2473 | val_acc: 0.6938
Epoch 75 - No improvement in validation loss.
Epoch: 76 | train_loss: 1.3491 | train_acc: 0.7215 | val_loss: 1.2657 | val_acc: 0.6894
Epoch 76 - No improvement in validation loss.
Epoch: 77 | train_loss: 1.3737 | train_acc: 0.7248 | val_loss: 1.2560 | val_acc: 0.6827
Epoch 77 - No improvement in validation loss.
Epoch: 78 | train_loss: 1.4582 | train_acc: 0.6851 | val_loss: 1.2254 | val_acc: 0.7046
Epoch 78 - No improvement in validation loss.
Epoch: 79 | train_loss: 1.3688 | train_acc: 0.7143 | val_loss: 1.2327 | val_acc: 0.7150
Epoch 79 - No improvement in validation loss.
Epoch: 80 | train_loss: 1.3912 | train_acc: 0.7107 | val_loss: 1.2464 | val_acc: 0.6964
Epoch 80 - No improvement in validation loss.
Epoch: 81 | train_loss: 1.3039 | train_acc: 0.7330 | val_loss: 1.2681 | val_acc: 0.6849
Epoch 81 - No improvement in validation loss.
Epoch: 82 | train_loss: 1.3802 | train_acc: 0.7277 | val_loss: 1.2452 | val_acc: 0.6685
Epoch 82 - No improvement in validation loss.
Epoch: 83 | train_loss: 1.4146 | train_acc: 0.6917 | val_loss: 1.2583 | val_acc: 0.6916
Epoch 83 - No improvement in validation loss.
Epoch: 84 | train_loss: 1.3689 | train_acc: 0.7315 | val_loss: 1.2250 | val_acc: 0.7039
Epoch 84 - No improvement in validation loss.
Epoch: 85 | train_loss: 1.3504 | train_acc: 0.7345 | val_loss: 1.2373 | val_acc: 0.7005
Epoch 85 - No improvement in validation loss.
Epoch: 86 | train_loss: 1.4137 | train_acc: 0.7177 | val_loss: 1.2211 | val_acc: 0.6927
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 87 | train_loss: 1.3928 | train_acc: 0.7237 | val_loss: 1.2324 | val_acc: 0.7087
Epoch 87 - No improvement in validation loss.
Epoch: 88 | train_loss: 1.3965 | train_acc: 0.7412 | val_loss: 1.2408 | val_acc: 0.7117
Epoch 88 - No improvement in validation loss.
Epoch: 89 | train_loss: 1.3487 | train_acc: 0.7290 | val_loss: 1.2121 | val_acc: 0.7094
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 90 | train_loss: 1.3459 | train_acc: 0.7279 | val_loss: 1.1934 | val_acc: 0.7228
Saved best model checkpoint to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Epoch: 91 | train_loss: 1.3542 | train_acc: 0.7479 | val_loss: 1.2292 | val_acc: 0.7050
Epoch 91 - No improvement in validation loss.
Epoch: 92 | train_loss: 1.2616 | train_acc: 0.7814 | val_loss: 1.2485 | val_acc: 0.7150
Epoch 92 - No improvement in validation loss.
Epoch: 93 | train_loss: 1.3831 | train_acc: 0.7078 | val_loss: 1.2220 | val_acc: 0.7117
Epoch 93 - No improvement in validation loss.
Epoch: 94 | train_loss: 1.3578 | train_acc: 0.7160 | val_loss: 1.2162 | val_acc: 0.7147
Epoch 94 - No improvement in validation loss.
Epoch: 95 | train_loss: 1.4581 | train_acc: 0.6807 | val_loss: 1.2073 | val_acc: 0.7113
Epoch 95 - No improvement in validation loss.
Epoch: 96 | train_loss: 1.3228 | train_acc: 0.7508 | val_loss: 1.2343 | val_acc: 0.6949
Epoch 96 - No improvement in validation loss.
Epoch: 97 | train_loss: 1.4717 | train_acc: 0.6797 | val_loss: 1.2262 | val_acc: 0.7124
Epoch 97 - No improvement in validation loss.
Epoch: 98 | train_loss: 1.3367 | train_acc: 0.7381 | val_loss: 1.2155 | val_acc: 0.7199
Epoch 98 - No improvement in validation loss.
Epoch: 99 | train_loss: 1.3544 | train_acc: 0.7361 | val_loss: 1.2126 | val_acc: 0.7106
Epoch 99 - No improvement in validation loss.
Epoch: 100 | train_loss: 1.3824 | train_acc: 0.7235 | val_loss: 1.2184 | val_acc: 0.7016
Epoch 100 - No improvement in validation loss.
Epoch: 101 | train_loss: 1.3964 | train_acc: 0.7095 | val_loss: 1.2261 | val_acc: 0.7161
Epoch 101 - No improvement in validation loss.
Epoch: 102 | train_loss: 1.4026 | train_acc: 0.6938 | val_loss: 1.2387 | val_acc: 0.7050
Epoch 102 - No improvement in validation loss.
Epoch: 103 | train_loss: 1.4139 | train_acc: 0.7236 | val_loss: 1.2488 | val_acc: 0.7094
Epoch 103 - No improvement in validation loss.
Epoch: 104 | train_loss: 1.3374 | train_acc: 0.7309 | val_loss: 1.2212 | val_acc: 0.7173
Epoch 104 - No improvement in validation loss.
Epoch: 105 | train_loss: 1.3893 | train_acc: 0.7301 | val_loss: 1.2295 | val_acc: 0.7135
Epoch 105 - No improvement in validation loss.
Epoch: 106 | train_loss: 1.3142 | train_acc: 0.7552 | val_loss: 1.2347 | val_acc: 0.7169
Epoch 106 - No improvement in validation loss.
Epoch: 107 | train_loss: 1.4357 | train_acc: 0.7045 | val_loss: 1.2421 | val_acc: 0.7050
Epoch 107 - No improvement in validation loss.
Epoch: 108 | train_loss: 1.3780 | train_acc: 0.7288 | val_loss: 1.2112 | val_acc: 0.7214
Epoch 108 - No improvement in validation loss.
Epoch: 109 | train_loss: 1.2686 | train_acc: 0.7641 | val_loss: 1.2258 | val_acc: 0.7106
Epoch 109 - No improvement in validation loss.
Epoch: 110 | train_loss: 1.3497 | train_acc: 0.7351 | val_loss: 1.2189 | val_acc: 0.7117
Epoch 110 - No improvement in validation loss.
Early stopping triggered after 20 epochs without improvement.
Training finished. Best validation loss: 1.1934 achieved. Best model saved to checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Loading best model from checkpoints/best_model_slurm_44099_2025-05-11 08:49:39.387465.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2169, Test Accuracy: 0.6989
Python script finished with exit code 0 at Sun May 11 10:03:08 AM CDT 2025
