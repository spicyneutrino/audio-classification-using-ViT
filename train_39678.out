Job started on ptolemy-gpu-02 at Wed Apr 30 03:49:53 PM CDT 2025
SLURM Job ID: 39678
Number of CPUs allocated: 4
Memory allocated: 
Batch size: 64
This job has 4 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 3e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 4
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.0991 | train_acc: 0.2395 | val_loss: 1.8229 | val_acc: 0.3353
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 2 | train_loss: 1.8871 | train_acc: 0.3519 | val_loss: 1.7259 | val_acc: 0.3978
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 3 | train_loss: 1.7222 | train_acc: 0.4403 | val_loss: 1.6736 | val_acc: 0.4627
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 4 | train_loss: 1.5991 | train_acc: 0.5082 | val_loss: 1.5732 | val_acc: 0.5449
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 5 | train_loss: 1.5140 | train_acc: 0.5544 | val_loss: 1.5547 | val_acc: 0.5733
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 6 | train_loss: 1.4383 | train_acc: 0.5872 | val_loss: 1.4610 | val_acc: 0.5873
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 7 | train_loss: 1.3880 | train_acc: 0.6163 | val_loss: 1.5047 | val_acc: 0.6050
Epoch 7 - No improvement in validation loss.
Epoch: 8 | train_loss: 1.3394 | train_acc: 0.6406 | val_loss: 1.4239 | val_acc: 0.6194
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 9 | train_loss: 1.3214 | train_acc: 0.6507 | val_loss: 1.4303 | val_acc: 0.6138
Epoch 9 - No improvement in validation loss.
Epoch: 10 | train_loss: 1.2730 | train_acc: 0.6758 | val_loss: 1.3812 | val_acc: 0.6202
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 11 | train_loss: 1.2456 | train_acc: 0.6954 | val_loss: 1.4071 | val_acc: 0.6250
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 1.2222 | train_acc: 0.7037 | val_loss: 1.3946 | val_acc: 0.6386
Epoch 12 - No improvement in validation loss.
Epoch: 13 | train_loss: 1.1899 | train_acc: 0.7146 | val_loss: 1.3373 | val_acc: 0.6238
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 14 | train_loss: 1.1698 | train_acc: 0.7265 | val_loss: 1.3881 | val_acc: 0.6258
Epoch 14 - No improvement in validation loss.
Epoch: 15 | train_loss: 1.1664 | train_acc: 0.7323 | val_loss: 1.3205 | val_acc: 0.6354
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 16 | train_loss: 1.1410 | train_acc: 0.7369 | val_loss: 1.3472 | val_acc: 0.6454
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 1.1232 | train_acc: 0.7487 | val_loss: 1.2787 | val_acc: 0.6522
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 18 | train_loss: 1.1146 | train_acc: 0.7510 | val_loss: 1.3104 | val_acc: 0.6322
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 1.0949 | train_acc: 0.7634 | val_loss: 1.3262 | val_acc: 0.6623
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 1.0861 | train_acc: 0.7621 | val_loss: 1.2570 | val_acc: 0.6530
Saved best model checkpoint to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Epoch: 21 | train_loss: 1.0794 | train_acc: 0.7658 | val_loss: 1.2994 | val_acc: 0.6502
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 1.0614 | train_acc: 0.7727 | val_loss: 1.3089 | val_acc: 0.6466
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.0400 | train_acc: 0.7815 | val_loss: 1.3002 | val_acc: 0.6567
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 1.0411 | train_acc: 0.7892 | val_loss: 1.2811 | val_acc: 0.6647
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.0274 | train_acc: 0.7886 | val_loss: 1.3100 | val_acc: 0.6526
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 1.0088 | train_acc: 0.7991 | val_loss: 1.2840 | val_acc: 0.6611
Epoch 26 - No improvement in validation loss.
Epoch: 27 | train_loss: 1.0093 | train_acc: 0.7903 | val_loss: 1.3267 | val_acc: 0.6442
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 0.9969 | train_acc: 0.8026 | val_loss: 1.3088 | val_acc: 0.6406
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 0.9894 | train_acc: 0.8083 | val_loss: 1.3210 | val_acc: 0.6558
Epoch 29 - No improvement in validation loss.
Epoch: 30 | train_loss: 0.9954 | train_acc: 0.8033 | val_loss: 1.3193 | val_acc: 0.6402
Epoch 30 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2570 achieved. Best model saved to checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Loading best model from checkpoints/best_model_slurm_39678_2025-04-30 15:50:05.578163.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2336, Test Accuracy: 0.6723
Python script finished with exit code 0 at Wed Apr 30 04:33:36 PM CDT 2025
