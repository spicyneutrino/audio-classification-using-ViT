Job started on ptolemy-gpu-02 at Thu May  1 09:11:20 AM CDT 2025
SLURM Job ID: 39912
Number of CPUs allocated: 64
Memory allocated: 
Batch size: 72
This job has 64 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 5e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 64
Batch size: 72
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.1235 | train_acc: 0.2310 | val_loss: 1.8482 | val_acc: 0.3310
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 2 | train_loss: 1.8992 | train_acc: 0.3456 | val_loss: 1.7519 | val_acc: 0.3819
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 3 | train_loss: 1.7454 | train_acc: 0.4229 | val_loss: 1.6032 | val_acc: 0.5174
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 4 | train_loss: 1.6164 | train_acc: 0.4935 | val_loss: 1.5897 | val_acc: 0.5208
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 5 | train_loss: 1.5329 | train_acc: 0.5374 | val_loss: 1.4944 | val_acc: 0.5891
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 6 | train_loss: 1.4472 | train_acc: 0.5863 | val_loss: 1.4856 | val_acc: 0.5729
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 7 | train_loss: 1.4051 | train_acc: 0.6144 | val_loss: 1.4195 | val_acc: 0.6065
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 8 | train_loss: 1.3521 | train_acc: 0.6372 | val_loss: 1.4408 | val_acc: 0.6042
Epoch 8 - No improvement in validation loss.
Epoch: 9 | train_loss: 1.3284 | train_acc: 0.6482 | val_loss: 1.4022 | val_acc: 0.6146
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 10 | train_loss: 1.2870 | train_acc: 0.6618 | val_loss: 1.3732 | val_acc: 0.6354
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 11 | train_loss: 1.2617 | train_acc: 0.6814 | val_loss: 1.3915 | val_acc: 0.6146
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 1.2343 | train_acc: 0.6944 | val_loss: 1.3651 | val_acc: 0.6285
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 13 | train_loss: 1.2164 | train_acc: 0.6979 | val_loss: 1.4060 | val_acc: 0.6157
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 1.1821 | train_acc: 0.7132 | val_loss: 1.3513 | val_acc: 0.6447
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 15 | train_loss: 1.1882 | train_acc: 0.7199 | val_loss: 1.2774 | val_acc: 0.6505
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 16 | train_loss: 1.1615 | train_acc: 0.7232 | val_loss: 1.2862 | val_acc: 0.6505
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 1.1388 | train_acc: 0.7389 | val_loss: 1.2745 | val_acc: 0.6516
Saved best model checkpoint to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Epoch: 18 | train_loss: 1.1228 | train_acc: 0.7452 | val_loss: 1.3112 | val_acc: 0.6620
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 1.1159 | train_acc: 0.7446 | val_loss: 1.3169 | val_acc: 0.6597
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 1.1013 | train_acc: 0.7580 | val_loss: 1.2757 | val_acc: 0.6736
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 1.0868 | train_acc: 0.7606 | val_loss: 1.2908 | val_acc: 0.6528
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 1.0696 | train_acc: 0.7677 | val_loss: 1.3171 | val_acc: 0.6736
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.0637 | train_acc: 0.7677 | val_loss: 1.3013 | val_acc: 0.6759
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 1.0689 | train_acc: 0.7698 | val_loss: 1.2915 | val_acc: 0.6806
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.0455 | train_acc: 0.7769 | val_loss: 1.3014 | val_acc: 0.6713
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 1.0310 | train_acc: 0.7853 | val_loss: 1.2774 | val_acc: 0.6852
Epoch 26 - No improvement in validation loss.
Epoch: 27 | train_loss: 1.0383 | train_acc: 0.7744 | val_loss: 1.2845 | val_acc: 0.6956
Epoch 27 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2745 achieved. Best model saved to checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Loading best model from checkpoints/best_model_slurm_39912_2025-05-01 09:11:30.947461.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2093, Test Accuracy: 0.6829
Python script finished with exit code 0 at Thu May  1 09:38:00 AM CDT 2025
