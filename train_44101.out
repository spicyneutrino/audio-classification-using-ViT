Job started on ptolemy-gpu-04 at Sun May 11 08:50:24 AM CDT 2025
SLURM Job ID: 44101
Number of CPUs allocated: 32
Memory allocated: 
Batch size: 64
This job has 32 worker and 500 epochs assigned.
HEAD_LR: 8e-5 | ENCODER_LR: 1e-5 | USE_TIME_AUGMENT: True
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 32
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.2011 | train_acc: 0.2173 | val_loss: 1.9280 | val_acc: 0.2821
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 2 | train_loss: 2.0561 | train_acc: 0.2768 | val_loss: 1.8319 | val_acc: 0.3602
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 3 | train_loss: 1.9784 | train_acc: 0.3300 | val_loss: 1.7605 | val_acc: 0.4331
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 4 | train_loss: 1.9436 | train_acc: 0.3583 | val_loss: 1.6727 | val_acc: 0.4643
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 5 | train_loss: 1.8467 | train_acc: 0.4153 | val_loss: 1.6394 | val_acc: 0.5016
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 6 | train_loss: 1.8117 | train_acc: 0.4437 | val_loss: 1.5862 | val_acc: 0.5232
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 7 | train_loss: 1.8144 | train_acc: 0.4574 | val_loss: 1.5501 | val_acc: 0.5345
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 8 | train_loss: 1.7808 | train_acc: 0.4713 | val_loss: 1.5372 | val_acc: 0.5317
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 9 | train_loss: 1.7542 | train_acc: 0.4911 | val_loss: 1.5231 | val_acc: 0.5661
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 10 | train_loss: 1.7195 | train_acc: 0.5081 | val_loss: 1.4829 | val_acc: 0.5385
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 11 | train_loss: 1.7338 | train_acc: 0.5024 | val_loss: 1.4764 | val_acc: 0.5465
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 12 | train_loss: 1.6942 | train_acc: 0.5356 | val_loss: 1.4610 | val_acc: 0.5753
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 13 | train_loss: 1.6875 | train_acc: 0.5355 | val_loss: 1.4645 | val_acc: 0.5982
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 1.6345 | train_acc: 0.5651 | val_loss: 1.4264 | val_acc: 0.5913
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 15 | train_loss: 1.6231 | train_acc: 0.5789 | val_loss: 1.4389 | val_acc: 0.6086
Epoch 15 - No improvement in validation loss.
Epoch: 16 | train_loss: 1.6406 | train_acc: 0.5573 | val_loss: 1.3945 | val_acc: 0.6234
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 17 | train_loss: 1.5919 | train_acc: 0.5893 | val_loss: 1.4012 | val_acc: 0.6354
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 1.5760 | train_acc: 0.5992 | val_loss: 1.3710 | val_acc: 0.6382
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 19 | train_loss: 1.5971 | train_acc: 0.6100 | val_loss: 1.3895 | val_acc: 0.6334
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 1.5676 | train_acc: 0.6131 | val_loss: 1.3780 | val_acc: 0.6478
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 1.5787 | train_acc: 0.5987 | val_loss: 1.3509 | val_acc: 0.6490
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 22 | train_loss: 1.5418 | train_acc: 0.6076 | val_loss: 1.3540 | val_acc: 0.6562
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.5412 | train_acc: 0.6289 | val_loss: 1.3362 | val_acc: 0.6466
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 24 | train_loss: 1.5721 | train_acc: 0.6081 | val_loss: 1.3555 | val_acc: 0.6639
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.5645 | train_acc: 0.6158 | val_loss: 1.3265 | val_acc: 0.6542
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 26 | train_loss: 1.5607 | train_acc: 0.6139 | val_loss: 1.3285 | val_acc: 0.6302
Epoch 26 - No improvement in validation loss.
Epoch: 27 | train_loss: 1.5422 | train_acc: 0.6147 | val_loss: 1.3614 | val_acc: 0.6627
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 1.5277 | train_acc: 0.6303 | val_loss: 1.3180 | val_acc: 0.6699
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 29 | train_loss: 1.5277 | train_acc: 0.6344 | val_loss: 1.3224 | val_acc: 0.6715
Epoch 29 - No improvement in validation loss.
Epoch: 30 | train_loss: 1.4862 | train_acc: 0.6366 | val_loss: 1.3315 | val_acc: 0.6542
Epoch 30 - No improvement in validation loss.
Epoch: 31 | train_loss: 1.4910 | train_acc: 0.6467 | val_loss: 1.3255 | val_acc: 0.6550
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 1.4841 | train_acc: 0.6583 | val_loss: 1.3326 | val_acc: 0.6719
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 1.4939 | train_acc: 0.6612 | val_loss: 1.3164 | val_acc: 0.6562
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 34 | train_loss: 1.4894 | train_acc: 0.6557 | val_loss: 1.3245 | val_acc: 0.6591
Epoch 34 - No improvement in validation loss.
Epoch: 35 | train_loss: 1.5227 | train_acc: 0.6460 | val_loss: 1.2829 | val_acc: 0.6783
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 36 | train_loss: 1.4958 | train_acc: 0.6620 | val_loss: 1.3250 | val_acc: 0.6687
Epoch 36 - No improvement in validation loss.
Epoch: 37 | train_loss: 1.4623 | train_acc: 0.6731 | val_loss: 1.2766 | val_acc: 0.6795
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 38 | train_loss: 1.4168 | train_acc: 0.6910 | val_loss: 1.2675 | val_acc: 0.6695
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 39 | train_loss: 1.4495 | train_acc: 0.6739 | val_loss: 1.2855 | val_acc: 0.6771
Epoch 39 - No improvement in validation loss.
Epoch: 40 | train_loss: 1.4709 | train_acc: 0.6649 | val_loss: 1.2977 | val_acc: 0.6795
Epoch 40 - No improvement in validation loss.
Epoch: 41 | train_loss: 1.3784 | train_acc: 0.6949 | val_loss: 1.2779 | val_acc: 0.6667
Epoch 41 - No improvement in validation loss.
Epoch: 42 | train_loss: 1.4306 | train_acc: 0.6933 | val_loss: 1.2687 | val_acc: 0.6951
Epoch 42 - No improvement in validation loss.
Epoch: 43 | train_loss: 1.4406 | train_acc: 0.6778 | val_loss: 1.2681 | val_acc: 0.6815
Epoch 43 - No improvement in validation loss.
Epoch: 44 | train_loss: 1.4308 | train_acc: 0.6953 | val_loss: 1.2461 | val_acc: 0.6839
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 45 | train_loss: 1.3993 | train_acc: 0.6993 | val_loss: 1.2461 | val_acc: 0.6815
Epoch 45 - No improvement in validation loss.
Epoch: 46 | train_loss: 1.4197 | train_acc: 0.6932 | val_loss: 1.2469 | val_acc: 0.6787
Epoch 46 - No improvement in validation loss.
Epoch: 47 | train_loss: 1.4029 | train_acc: 0.6987 | val_loss: 1.2501 | val_acc: 0.7047
Epoch 47 - No improvement in validation loss.
Epoch: 48 | train_loss: 1.4544 | train_acc: 0.6804 | val_loss: 1.2484 | val_acc: 0.7035
Epoch 48 - No improvement in validation loss.
Epoch: 49 | train_loss: 1.3879 | train_acc: 0.6959 | val_loss: 1.2630 | val_acc: 0.6891
Epoch 49 - No improvement in validation loss.
Epoch: 50 | train_loss: 1.4393 | train_acc: 0.6986 | val_loss: 1.2297 | val_acc: 0.7167
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 51 | train_loss: 1.3785 | train_acc: 0.7145 | val_loss: 1.2262 | val_acc: 0.7119
Saved best model checkpoint to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Epoch: 52 | train_loss: 1.4446 | train_acc: 0.6896 | val_loss: 1.2549 | val_acc: 0.6979
Epoch 52 - No improvement in validation loss.
Epoch: 53 | train_loss: 1.3826 | train_acc: 0.7241 | val_loss: 1.2477 | val_acc: 0.7119
Epoch 53 - No improvement in validation loss.
Epoch: 54 | train_loss: 1.3557 | train_acc: 0.7331 | val_loss: 1.2367 | val_acc: 0.7047
Epoch 54 - No improvement in validation loss.
Epoch: 55 | train_loss: 1.4085 | train_acc: 0.7054 | val_loss: 1.2461 | val_acc: 0.6975
Epoch 55 - No improvement in validation loss.
Epoch: 56 | train_loss: 1.3928 | train_acc: 0.7126 | val_loss: 1.2819 | val_acc: 0.6867
Epoch 56 - No improvement in validation loss.
Epoch: 57 | train_loss: 1.4109 | train_acc: 0.7033 | val_loss: 1.2552 | val_acc: 0.7119
Epoch 57 - No improvement in validation loss.
Epoch: 58 | train_loss: 1.2957 | train_acc: 0.7450 | val_loss: 1.3221 | val_acc: 0.6939
Epoch 58 - No improvement in validation loss.
Epoch: 59 | train_loss: 1.4320 | train_acc: 0.7141 | val_loss: 1.2721 | val_acc: 0.6879
Epoch 59 - No improvement in validation loss.
Epoch: 60 | train_loss: 1.3916 | train_acc: 0.7109 | val_loss: 1.2688 | val_acc: 0.7047
Epoch 60 - No improvement in validation loss.
Epoch: 61 | train_loss: 1.4148 | train_acc: 0.7042 | val_loss: 1.2906 | val_acc: 0.6867
Epoch 61 - No improvement in validation loss.
Epoch: 62 | train_loss: 1.3261 | train_acc: 0.7339 | val_loss: 1.2570 | val_acc: 0.6883
Epoch 62 - No improvement in validation loss.
Epoch: 63 | train_loss: 1.3483 | train_acc: 0.7197 | val_loss: 1.2488 | val_acc: 0.6971
Epoch 63 - No improvement in validation loss.
Epoch: 64 | train_loss: 1.3362 | train_acc: 0.7396 | val_loss: 1.2568 | val_acc: 0.6987
Epoch 64 - No improvement in validation loss.
Epoch: 65 | train_loss: 1.3943 | train_acc: 0.7195 | val_loss: 1.2484 | val_acc: 0.7027
Epoch 65 - No improvement in validation loss.
Epoch: 66 | train_loss: 1.3048 | train_acc: 0.7667 | val_loss: 1.2543 | val_acc: 0.7023
Epoch 66 - No improvement in validation loss.
Epoch: 67 | train_loss: 1.3629 | train_acc: 0.7313 | val_loss: 1.2281 | val_acc: 0.7023
Epoch 67 - No improvement in validation loss.
Epoch: 68 | train_loss: 1.4233 | train_acc: 0.7119 | val_loss: 1.2296 | val_acc: 0.6927
Epoch 68 - No improvement in validation loss.
Epoch: 69 | train_loss: 1.3454 | train_acc: 0.7383 | val_loss: 1.2352 | val_acc: 0.7027
Epoch 69 - No improvement in validation loss.
Epoch: 70 | train_loss: 1.3548 | train_acc: 0.7390 | val_loss: 1.2621 | val_acc: 0.6935
Epoch 70 - No improvement in validation loss.
Epoch: 71 | train_loss: 1.3660 | train_acc: 0.7379 | val_loss: 1.2542 | val_acc: 0.6947
Epoch 71 - No improvement in validation loss.
Early stopping triggered after 20 epochs without improvement.
Training finished. Best validation loss: 1.2262 achieved. Best model saved to checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Loading best model from checkpoints/best_model_slurm_44101_2025-05-11 08:50:33.594949.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2032, Test Accuracy: 0.7123
Python script finished with exit code 0 at Sun May 11 09:38:42 AM CDT 2025
