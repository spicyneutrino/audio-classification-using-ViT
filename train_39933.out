Job started on ptolemy-gpu-01 at Thu May  1 10:11:53 AM CDT 2025
SLURM Job ID: 39933
Number of CPUs allocated: 4
Memory allocated: 
Batch size: 64
This job has 4 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 3e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 4
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.0665 | train_acc: 0.2674 | val_loss: 1.8542 | val_acc: 0.3417
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 2 | train_loss: 1.7591 | train_acc: 0.4023 | val_loss: 1.6791 | val_acc: 0.4732
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 3 | train_loss: 1.5809 | train_acc: 0.5028 | val_loss: 1.5711 | val_acc: 0.5385
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 4 | train_loss: 1.4508 | train_acc: 0.5756 | val_loss: 1.4964 | val_acc: 0.5156
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 5 | train_loss: 1.3618 | train_acc: 0.6224 | val_loss: 1.4417 | val_acc: 0.6302
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 6 | train_loss: 1.2933 | train_acc: 0.6632 | val_loss: 1.3974 | val_acc: 0.6466
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 7 | train_loss: 1.2160 | train_acc: 0.7049 | val_loss: 1.3811 | val_acc: 0.6422
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 8 | train_loss: 1.1746 | train_acc: 0.7184 | val_loss: 1.3946 | val_acc: 0.6470
Epoch 8 - No improvement in validation loss.
Epoch: 9 | train_loss: 1.1339 | train_acc: 0.7477 | val_loss: 1.4351 | val_acc: 0.6450
Epoch 9 - No improvement in validation loss.
Epoch: 10 | train_loss: 1.1022 | train_acc: 0.7605 | val_loss: 1.3337 | val_acc: 0.6434
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 11 | train_loss: 1.0726 | train_acc: 0.7698 | val_loss: 1.3894 | val_acc: 0.6262
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 1.0378 | train_acc: 0.7875 | val_loss: 1.3464 | val_acc: 0.6763
Epoch 12 - No improvement in validation loss.
Epoch: 13 | train_loss: 1.0078 | train_acc: 0.8005 | val_loss: 1.3468 | val_acc: 0.6703
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 0.9962 | train_acc: 0.8046 | val_loss: 1.3644 | val_acc: 0.6583
Epoch 14 - No improvement in validation loss.
Epoch: 15 | train_loss: 0.9690 | train_acc: 0.8178 | val_loss: 1.3855 | val_acc: 0.6534
Epoch 15 - No improvement in validation loss.
Epoch: 16 | train_loss: 0.9527 | train_acc: 0.8268 | val_loss: 1.3354 | val_acc: 0.6639
Epoch 16 - No improvement in validation loss.
Epoch: 17 | train_loss: 0.9388 | train_acc: 0.8332 | val_loss: 1.3432 | val_acc: 0.6703
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 0.9161 | train_acc: 0.8428 | val_loss: 1.3797 | val_acc: 0.6286
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 0.8987 | train_acc: 0.8539 | val_loss: 1.3677 | val_acc: 0.6575
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 0.8814 | train_acc: 0.8572 | val_loss: 1.3175 | val_acc: 0.6454
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 21 | train_loss: 0.8712 | train_acc: 0.8639 | val_loss: 1.3273 | val_acc: 0.6715
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 0.8524 | train_acc: 0.8680 | val_loss: 1.4044 | val_acc: 0.6550
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 0.8485 | train_acc: 0.8748 | val_loss: 1.3204 | val_acc: 0.6571
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 0.8372 | train_acc: 0.8755 | val_loss: 1.3503 | val_acc: 0.6675
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 0.8258 | train_acc: 0.8841 | val_loss: 1.3349 | val_acc: 0.6687
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 0.8180 | train_acc: 0.8880 | val_loss: 1.4490 | val_acc: 0.6390
Epoch 26 - No improvement in validation loss.
Epoch: 27 | train_loss: 0.8071 | train_acc: 0.8902 | val_loss: 1.3797 | val_acc: 0.6631
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 0.7950 | train_acc: 0.8965 | val_loss: 1.3270 | val_acc: 0.6935
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 0.8002 | train_acc: 0.8963 | val_loss: 1.2892 | val_acc: 0.6799
Saved best model checkpoint to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Epoch: 30 | train_loss: 0.7842 | train_acc: 0.9001 | val_loss: 1.3354 | val_acc: 0.6655
Epoch 30 - No improvement in validation loss.
Epoch: 31 | train_loss: 0.7777 | train_acc: 0.9062 | val_loss: 1.4436 | val_acc: 0.6550
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 0.7761 | train_acc: 0.9047 | val_loss: 1.3644 | val_acc: 0.6723
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 0.7707 | train_acc: 0.9069 | val_loss: 1.3359 | val_acc: 0.6887
Epoch 33 - No improvement in validation loss.
Epoch: 34 | train_loss: 0.7563 | train_acc: 0.9147 | val_loss: 1.3648 | val_acc: 0.6723
Epoch 34 - No improvement in validation loss.
Epoch: 35 | train_loss: 0.7577 | train_acc: 0.9142 | val_loss: 1.3899 | val_acc: 0.6683
Epoch 35 - No improvement in validation loss.
Epoch: 36 | train_loss: 0.7454 | train_acc: 0.9192 | val_loss: 1.3587 | val_acc: 0.6659
Epoch 36 - No improvement in validation loss.
Epoch: 37 | train_loss: 0.7446 | train_acc: 0.9184 | val_loss: 1.3649 | val_acc: 0.6647
Epoch 37 - No improvement in validation loss.
Epoch: 38 | train_loss: 0.7297 | train_acc: 0.9242 | val_loss: 1.3618 | val_acc: 0.6647
Epoch 38 - No improvement in validation loss.
Epoch: 39 | train_loss: 0.7321 | train_acc: 0.9230 | val_loss: 1.3537 | val_acc: 0.6755
Epoch 39 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2892 achieved. Best model saved to checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Loading best model from checkpoints/best_model_slurm_39933_2025-05-01 10:12:03.879752.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.3107, Test Accuracy: 0.6788
Python script finished with exit code 0 at Thu May  1 10:37:57 AM CDT 2025
