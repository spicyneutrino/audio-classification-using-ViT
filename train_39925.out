Job started on ptolemy-gpu-01 at Thu May  1 09:55:37 AM CDT 2025
SLURM Job ID: 39925
Number of CPUs allocated: 32
Memory allocated: 
Batch size: 72
This job has 32 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 5e-2 | with Time Augmentations
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 32
Batch size: 72
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.1067 | train_acc: 0.2462 | val_loss: 1.8637 | val_acc: 0.3333
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 2 | train_loss: 1.9000 | train_acc: 0.3442 | val_loss: 1.7347 | val_acc: 0.4248
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 3 | train_loss: 1.7551 | train_acc: 0.4152 | val_loss: 1.6674 | val_acc: 0.4271
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 4 | train_loss: 1.6369 | train_acc: 0.4809 | val_loss: 1.5291 | val_acc: 0.5174
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 5 | train_loss: 1.5416 | train_acc: 0.5329 | val_loss: 1.4937 | val_acc: 0.5382
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 6 | train_loss: 1.4744 | train_acc: 0.5648 | val_loss: 1.4908 | val_acc: 0.5637
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 7 | train_loss: 1.4054 | train_acc: 0.6093 | val_loss: 1.4568 | val_acc: 0.5938
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 8 | train_loss: 1.3620 | train_acc: 0.6259 | val_loss: 1.4168 | val_acc: 0.5787
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 9 | train_loss: 1.3337 | train_acc: 0.6408 | val_loss: 1.3801 | val_acc: 0.6146
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 10 | train_loss: 1.2994 | train_acc: 0.6618 | val_loss: 1.3851 | val_acc: 0.6157
Epoch 10 - No improvement in validation loss.
Epoch: 11 | train_loss: 1.2709 | train_acc: 0.6797 | val_loss: 1.3743 | val_acc: 0.6470
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 12 | train_loss: 1.2390 | train_acc: 0.6921 | val_loss: 1.3630 | val_acc: 0.6551
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 13 | train_loss: 1.2251 | train_acc: 0.6964 | val_loss: 1.4120 | val_acc: 0.6308
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 1.1958 | train_acc: 0.7105 | val_loss: 1.3467 | val_acc: 0.6366
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 15 | train_loss: 1.1735 | train_acc: 0.7250 | val_loss: 1.3377 | val_acc: 0.6609
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 16 | train_loss: 1.1532 | train_acc: 0.7323 | val_loss: 1.3015 | val_acc: 0.6586
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 17 | train_loss: 1.1321 | train_acc: 0.7404 | val_loss: 1.2945 | val_acc: 0.6551
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 18 | train_loss: 1.1267 | train_acc: 0.7389 | val_loss: 1.2937 | val_acc: 0.6493
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 19 | train_loss: 1.1156 | train_acc: 0.7500 | val_loss: 1.2800 | val_acc: 0.6516
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 20 | train_loss: 1.0899 | train_acc: 0.7617 | val_loss: 1.2623 | val_acc: 0.6609
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 21 | train_loss: 1.0793 | train_acc: 0.7660 | val_loss: 1.2949 | val_acc: 0.6458
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 1.0640 | train_acc: 0.7728 | val_loss: 1.2677 | val_acc: 0.6586
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 1.0586 | train_acc: 0.7723 | val_loss: 1.3080 | val_acc: 0.6493
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 1.0494 | train_acc: 0.7745 | val_loss: 1.2671 | val_acc: 0.6701
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 1.0397 | train_acc: 0.7792 | val_loss: 1.2640 | val_acc: 0.6620
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 1.0305 | train_acc: 0.7847 | val_loss: 1.2622 | val_acc: 0.6632
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 27 | train_loss: 1.0229 | train_acc: 0.7942 | val_loss: 1.2907 | val_acc: 0.6597
Epoch 27 - No improvement in validation loss.
Epoch: 28 | train_loss: 1.0135 | train_acc: 0.7957 | val_loss: 1.3046 | val_acc: 0.6586
Epoch 28 - No improvement in validation loss.
Epoch: 29 | train_loss: 0.9904 | train_acc: 0.8037 | val_loss: 1.2237 | val_acc: 0.6806
Saved best model checkpoint to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Epoch: 30 | train_loss: 0.9809 | train_acc: 0.8055 | val_loss: 1.2933 | val_acc: 0.6632
Epoch 30 - No improvement in validation loss.
Epoch: 31 | train_loss: 0.9931 | train_acc: 0.8076 | val_loss: 1.2446 | val_acc: 0.6667
Epoch 31 - No improvement in validation loss.
Epoch: 32 | train_loss: 0.9770 | train_acc: 0.8070 | val_loss: 1.2952 | val_acc: 0.6759
Epoch 32 - No improvement in validation loss.
Epoch: 33 | train_loss: 0.9619 | train_acc: 0.8197 | val_loss: 1.2410 | val_acc: 0.6771
Epoch 33 - No improvement in validation loss.
Epoch: 34 | train_loss: 0.9633 | train_acc: 0.8172 | val_loss: 1.2993 | val_acc: 0.6794
Epoch 34 - No improvement in validation loss.
Epoch: 35 | train_loss: 0.9515 | train_acc: 0.8185 | val_loss: 1.2757 | val_acc: 0.6829
Epoch 35 - No improvement in validation loss.
Epoch: 36 | train_loss: 0.9464 | train_acc: 0.8244 | val_loss: 1.2481 | val_acc: 0.6910
Epoch 36 - No improvement in validation loss.
Epoch: 37 | train_loss: 0.9407 | train_acc: 0.8269 | val_loss: 1.2279 | val_acc: 0.6875
Epoch 37 - No improvement in validation loss.
Epoch: 38 | train_loss: 0.9359 | train_acc: 0.8318 | val_loss: 1.2607 | val_acc: 0.6863
Epoch 38 - No improvement in validation loss.
Epoch: 39 | train_loss: 0.9332 | train_acc: 0.8335 | val_loss: 1.2565 | val_acc: 0.6991
Epoch 39 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.2237 achieved. Best model saved to checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Loading best model from checkpoints/best_model_slurm_39925_2025-05-01 09:55:48.744011.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2525, Test Accuracy: 0.6590
Python script finished with exit code 0 at Thu May  1 10:27:42 AM CDT 2025
