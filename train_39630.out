Job started on ptolemy-gpu-05 at Wed Apr 30 12:47:14 PM CDT 2025
SLURM Job ID: 39630
Number of CPUs allocated: 1
Memory allocated: 
Batch size: 64
This job has 1 worker and 100 epochs assigned.
unfrozen encoder layer= 2 | head_lr= 3e-4 | encoder_lr= 3e-5 | weight_decay= 3e-2 
Project Root: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Setting Torch cache to: /scratch/ptolemy/users/kg1623/.cache/torch
Setting Hugging Face cache to: /scratch/ptolemy/users/kg1623/.cache/huggingface
Current Directory: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT
Loading modules...
Activating existing virtual environment 'venv'...
PYTHONPATH: /scratch/ptolemy/users/kg1623/projects/deep-learning/audio-classification-using-ViT:
Running train.py script...
Using device: cuda
Number of workers: 1
Batch size: 64
Train dataset size: 7079
Validation dataset size: 816
Test dataset size: 837
Epoch: 1 | train_loss: 2.0001 | train_acc: 0.2883 | val_loss: 1.7783 | val_acc: 0.3858
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 2 | train_loss: 1.6802 | train_acc: 0.4540 | val_loss: 1.6526 | val_acc: 0.5064
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 3 | train_loss: 1.5017 | train_acc: 0.5506 | val_loss: 1.5413 | val_acc: 0.5304
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 4 | train_loss: 1.3680 | train_acc: 0.6228 | val_loss: 1.4478 | val_acc: 0.5994
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 5 | train_loss: 1.2718 | train_acc: 0.6704 | val_loss: 1.4215 | val_acc: 0.6134
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 6 | train_loss: 1.1897 | train_acc: 0.7086 | val_loss: 1.3960 | val_acc: 0.6110
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 7 | train_loss: 1.1452 | train_acc: 0.7361 | val_loss: 1.3777 | val_acc: 0.6490
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 8 | train_loss: 1.0883 | train_acc: 0.7625 | val_loss: 1.3724 | val_acc: 0.6695
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 9 | train_loss: 1.0524 | train_acc: 0.7801 | val_loss: 1.3872 | val_acc: 0.6366
Epoch 9 - No improvement in validation loss.
Epoch: 10 | train_loss: 1.0138 | train_acc: 0.7932 | val_loss: 1.3694 | val_acc: 0.6346
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 11 | train_loss: 0.9859 | train_acc: 0.8088 | val_loss: 1.3992 | val_acc: 0.6486
Epoch 11 - No improvement in validation loss.
Epoch: 12 | train_loss: 0.9609 | train_acc: 0.8216 | val_loss: 1.3567 | val_acc: 0.6274
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 13 | train_loss: 0.9344 | train_acc: 0.8301 | val_loss: 1.3656 | val_acc: 0.6510
Epoch 13 - No improvement in validation loss.
Epoch: 14 | train_loss: 0.9155 | train_acc: 0.8410 | val_loss: 1.3761 | val_acc: 0.6703
Epoch 14 - No improvement in validation loss.
Epoch: 15 | train_loss: 0.9070 | train_acc: 0.8415 | val_loss: 1.3806 | val_acc: 0.6526
Epoch 15 - No improvement in validation loss.
Epoch: 16 | train_loss: 0.8747 | train_acc: 0.8571 | val_loss: 1.3174 | val_acc: 0.6498
Saved best model checkpoint to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Epoch: 17 | train_loss: 0.8596 | train_acc: 0.8668 | val_loss: 1.3293 | val_acc: 0.6807
Epoch 17 - No improvement in validation loss.
Epoch: 18 | train_loss: 0.8441 | train_acc: 0.8724 | val_loss: 1.4031 | val_acc: 0.6446
Epoch 18 - No improvement in validation loss.
Epoch: 19 | train_loss: 0.8236 | train_acc: 0.8841 | val_loss: 1.3821 | val_acc: 0.6474
Epoch 19 - No improvement in validation loss.
Epoch: 20 | train_loss: 0.8129 | train_acc: 0.8889 | val_loss: 1.3317 | val_acc: 0.6538
Epoch 20 - No improvement in validation loss.
Epoch: 21 | train_loss: 0.8070 | train_acc: 0.8878 | val_loss: 1.3414 | val_acc: 0.6651
Epoch 21 - No improvement in validation loss.
Epoch: 22 | train_loss: 0.7926 | train_acc: 0.8994 | val_loss: 1.3522 | val_acc: 0.6474
Epoch 22 - No improvement in validation loss.
Epoch: 23 | train_loss: 0.7819 | train_acc: 0.8977 | val_loss: 1.3423 | val_acc: 0.6422
Epoch 23 - No improvement in validation loss.
Epoch: 24 | train_loss: 0.7772 | train_acc: 0.8975 | val_loss: 1.3469 | val_acc: 0.6659
Epoch 24 - No improvement in validation loss.
Epoch: 25 | train_loss: 0.7716 | train_acc: 0.9050 | val_loss: 1.3516 | val_acc: 0.6663
Epoch 25 - No improvement in validation loss.
Epoch: 26 | train_loss: 0.7527 | train_acc: 0.9113 | val_loss: 1.3493 | val_acc: 0.6631
Epoch 26 - No improvement in validation loss.
Early stopping triggered after 10 epochs without improvement.
Training finished. Best validation loss: 1.3174 achieved. Best model saved to checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Loading best model from checkpoints/best_model_slurm_39630_2025-04-30 12:47:27.251290.pth
Best model loaded successfully.

Evaluating best model on Test Dataset...

--- Final Test Results ---
Test Loss: 1.2856, Test Accuracy: 0.6821
Python script finished with exit code 0 at Wed Apr 30 01:33:18 PM CDT 2025
